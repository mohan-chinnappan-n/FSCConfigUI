<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Fetch Test in Aura</title>

<style>
h3 {
font-family:Helvetica Neue, Arial;
}
textarea {
 background-color: black;
 color:white;
 border-radius:5px;
 font-family: Monaco;
 padding:10px;
}
body {
  margin:20px;
}
</style>
</head>
<body>

<h3>
Example to show how to wrap a API callout (in case of localhost serving situations)<br/> 
in javascript as a function to be called in the aura client-side controller methods

</h3>
<textarea rows='3' cols='40' id='bal'></textarea>   
<script>


// the function to be in the bal.js  
window.getBal = async (url) => {
  // url may be a localhost server
  let response = await fetch(url);
  return await response.json()
}

const id = 100;
const bal = 300;
const url = `https://mohansun-rum.herokuapp.com/bal/${id}/${bal}`; 

getBal(url).then (data => {
    document.getElementById('bal').value = JSON.stringify(data);
}).catch(e => console.log(e));


/* --------------------------- STEPS ----------

- add this lib.js into static resources (say bal)
- add this url to 
    - CSP 
    - remote site settings

- In the component have script require tag:

<ltng:require scripts="{!$Resource.bal}" afterScriptsLoaded="{!c.afterScriptsLoaded}" />

- In the component controller:

{{

 afterScriptsLoaded: function(cmp, event, helper) {
   const id = 100;
   const bal = 300;
   const url = `https://mohansun-rum.herokuapp.com/bal/${id}/${bal}`; 
   
   window.getBal(url).then (data => {
   console.log(data);
   // do things with 'data' 
 }


}}

----------------------------------------------
*/
</script> 
</body>
</html>
